Скрипты для создания SQLite баз данных представлюющих граф дорожной сети

Требуются установленные spatialite-tools
    
    sudo apt-get install libspatialite-dev
    sudo apt-get install libspatialite5
    sudo apt-get install python-pyspatialite
    sudo apt-get install spatialite-bin

# Порядок работы

1. Загрузить с http://download.geofabrik.de файлы нужных регионов в формате OSM или PBF
  в каталоги с соответствующим названием. Каталоги должны лежать в папке со скриптом.

2. Создайте каталог sqlite для получившейся БД.

3. Запустить скрипт start_osm2sqlite.py

        chmod +x start_osm2sqlite.py
        ./start_osm2sqlite.py
    В каталоге "sqlite" будут созданы файлы sqlite баз данных из всех
    файлов в каталогах "osm" и "pbf"

4. Запустить скрипт start_filter_nodes.py

        chmod +x start_filter_nodes.py
        ./start_filter_nodes.py -d sqlite
    
    Для всех файлов в каталоге "sqlite" будет сделано следуещее:
    - найдены несвязные узлы графа дорожной сети
    - в таблице узлов будет создан дополнительный столбец "connected" в котором будет записана
     каждого связность узла (0 - несвязный, 1 = связный)
 
5. Запустить скрипт start_mkgrid.py

        chmod +x start_mkgrid.py
        ./start_mkgrid.py -s -u -m 2 -d sqlite
        
    для всех файлов дорожных сетей в каталоге sqlite бедет сделано следующее:
     - в таблице узлов будет добавлен столбец "sector" в котором для каждого
        узла будет записан номер сектора к которому он относится.
     - в таблице узлов будет создан индекс для поля "sector"
 
 
## Примечание

Параметры:
    
- d <путь к каталогу>
- s "тихий режим", не будет выводится справочная информация
- u если эта опция указана, то файл будет обработан в любом случае, 
    даже если он ранее уже обрабатывался и столбцы в таблицу добавлялись.
    Если опция не указана такой файл будет пропущен.
- m <целое число[1,2,3]> размер квадрата сетки: 2**m число, 
    во сколько раз размер квадрата сетки меньше градуса.
    
##Принцип деления на секторы
Для примера пусть m=1 и размер сектора будет равен 1 градусу.
Мысленно развернем земную поверхность на плоскость.

Тогда у нас будет сетка шириной 360 столбцов на 180 рядов, т.е. 
360*180=64800 секторов. Номера секторов будут с 0 до 64799.
Номера столбцов будут 0-359. Номера рядов 0-179.

Принадлежность точки сектору будет определятся целой частью ее 
широты и долготы. Чтобы уйти от отрицательных значений к широте точки прибавляется
90, а к долготе 180. Например точка с координатами 54.45 с.ш. и 34.17 в.д.
будет располагаться в 144 ряду  и 214 колонке. Номер сектора будет:
номер_ряда * 360 + номер_колонки.

При использовании m > 1 используется коэффициент scale = 2**m

Тогда: 

    row = math.floor(scale * (lat + 90))
    col = math.floor(scale * (lng + 180))
    sector = row * 360 * scale + col

параметр m не следует выбирать слишком большим, т.к. при сильно малом размере секторов
часть секторов может оказаться не содержащей узлов, и узлы для точек попавших в эти сектора 
вообще не будут найдены. Оптимальным представляется m=2


